---
title: API Reference

language_tabs: # must be one of https://git.io/vQNgJ
  - shell: Example
  - ruby
  - python
  - javascript

toc_footers:
  - <a href='https://merchant.cloudpayments.ru'>ЛК CP</a>
  - <a href='https://cloudpayments.ru'>Сайт CloudPayments</a>

includes:
  - API

search: true
---

# Общая Информация

Версия 2.1 от 27.09.2017

## Термины и определения

* **Система** — платежный шлюз CloudPayments.  
* **ТСП** — торгово-сервисное предприятие, работающее с системой.  
* **API** — программный интерфейс для взаимодействия с системой, расположенный по адресу https://api.cloudpayments.ru  
* **ЛК** — личный кабинет ТСП в системе, расположенный по адресу https://merchant.cloudpayments.ru  
* **Карта** — банковская карта платежных систем Visa, MasterCard или МИР.  
* **Эквайер** — расчетный банк.  
* **Эмитент** — банк, выпустивший карту.  
* **Держатель** — физическое лицо, которому эмитент выдал карту в пользование.  
* **Виджет** — платежная форма, предоставленная системой для ввода реквизитов карты держателем и последующей авторизации.  
* **3-D Secure** — протокол проверки держателя эмитентом.  

## Виды операций

Система предполагает два вида операций: оплата и возврат. В первом случае деньги перечисляются со счета держателя в пользу ТСП, во втором — наоборот. Возврат выполняет ТСП в случае желания покупателя вернуть товар, и он всегда связан с операцией оплаты, сумма средств с которой будет возвращена держателю. Возвращать можно как всю сумму оплаты, так и ее часть. Деньги обычно возвращаются на карту держателя в тот же день, но иногда (зависит от эмитента) могут идти до 3-х дней.
Операцию оплаты, в отличие от возврата, можно отменить. Отмену оплаты выполняет ТСП в случае, если платеж был совершен с ошибкой: неверная сумма, технический сбой и т.д. Есть ограничение — отменить операцию можно только в случае использования двустадийной схемы оплаты. Деньги при этом будут разблокированы на карте держателя практически мгновенно.

## Схемы проведения платежа
Существуют два варианта проведения операции оплаты: одно- и двухстадийная, их также называют *single message scheme* (SMS) и *dual message scheme* (DMS).  
 
**Одностадийная** оплата выполняется одной командой, по результатам которой проходит авторизация и последующее списание средств в пользу ТСП.  
 
**Двухстадийная** оплата подразумевает использование двух команд: отдельно на авторизацию, отдельно на списание. После успешной авторизации, сумма операции будет блокирована на счету держателя, то есть он не сможет ей воспользоваться. Далее у ТСП есть до 7 дней в зависимости от типа карты для подтверждения операции, после чего произойдет списание денег. Если операцию не подтвердить в течение этого времени — она будет автоматически отменена. Подтверждать можно как всю сумму авторизации, так и часть.  
Как правило, двухстадийная схема используется для получения депозита с плательщика, например, в прокатных компаниях или отелях.

В зависимости от настройки, система может автоматически выполнять подтверждение двустадийных платежей через указанное количество дней.




